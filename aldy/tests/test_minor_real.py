# 786
# Aldy source: test_minor_real.py
#   This file is subject to the terms and conditions defined in
#   file 'LICENSE', which is part of this source code package.


import pytest  # noqa

from .test_minor_synthetic import assert_minor


def test_normal(real_gene, solver):  # NA07439/v1 : currently test only one solution
    assert_minor(
        real_gene,
        solver,
        {
            "cn": {"1": 3},
            "major": {"4C": 2, "41": 1},
            "data": {
                (42522391, "G>A"): 353,
                (42522391, "_"): 177,
                (42522612, "C>G"): 689,
                (42522612, "_"): 0,
                (42523210, "T>C"): 347,
                (42523210, "_"): 198,
                (42523408, "T>G"): 811,
                (42523408, "_"): 0,
                (42523804, "C>T"): 160,
                (42523804, "_"): 392,
                (42523942, "G>A"): 208,
                (42523942, "_"): 394,
                (42524695, "T>C"): 489,
                (42524695, "_"): 248,
                (42524946, "C>T"): 483,
                (42524946, "_"): 303,
                (42525131, "C>G"): 640,
                (42525131, "_"): 0,
                (42525755, "G>A"): 340,
                (42525755, "_"): 174,
                (42525797, "G>C"): 0,
                (42525797, "_"): 197,
                (42525951, "A>C"): 640,
                (42525951, "_"): 0,
                (42526048, "G>C"): 431,
                (42526048, "_"): 287,
                (42526483, "C>A"): 643,
                (42526483, "_"): 0,
                (42526548, "T>C"): 284,
                (42526548, "_"): 343,
                (42526560, "T>G"): 283,
                (42526560, "_"): 303,
                (42526561, "C>G"): 288,
                (42526561, "_"): 301,
                (42526566, "A>G"): 298,
                (42526566, "_"): 322,
                (42526570, "G>C"): 302,
                (42526570, "_"): 313,
                (42526572, "G>T"): 297,
                (42526572, "_"): 324,
                (42526693, "G>A"): 665,
                (42526693, "_"): 330,
                (42527470, "C>T"): 377,
                (42527470, "_"): 351,
                (42527532, "G>A"): 259,
                (42527532, "_"): 351,
                (42527792, "C>T"): 333,
                (42527792, "_"): 200,
                (42528027, "T>C"): 46,
                (42528027, "_"): 0,
            },
            "sol": [
                (
                    "4.005",
                    [],
                    [
                        (42523408, "T>G"),
                        (42525951, "A>C"),
                        (42526048, "G>C"),
                        (42526483, "C>A"),
                        (42528027, "T>C"),
                    ],
                ),
                (
                    "4.005",
                    [],
                    [
                        (42523408, "T>G"),
                        (42525951, "A>C"),
                        (42526483, "C>A"),
                        (42528027, "T>C"),
                    ],
                ),
                (
                    "41.001",
                    [
                        (42522311, "C>T"),
                        (42523002, "G>A"),
                        (42523208, "C>T"),
                        (42526579, "C>G"),
                    ],
                    [],
                ),
            ],
        },
    )


def test_multiple(real_gene, solver):  # HG00436/v1
    assert_minor(
        real_gene,
        solver,
        {
            "cn": {"1": 3},
            "major": {"2": 2, "71": 1},
            "data": {
                (42522311, "C>T"): 643,
                (42522311, "_"): 143,
                (42522612, "C>G"): 634,
                (42522612, "_"): 357,
                (42522677, "G>A"): 0,
                (42522677, "_"): 1183,
                (42523002, "G>A"): 861,
                (42523002, "_"): 125,
                (42523208, "C>T"): 525,
                (42523208, "_"): 273,
                (42523408, "T>G"): 851,
                (42523408, "_"): 326,
                (42523942, "G>A"): 622,
                (42523942, "_"): 332,
                (42524217, "G>T"): 0,
                (42524217, "_"): 675,
                (42524312, "G>A"): 0,
                (42524312, "_"): 919,
                (42524322, "A>G"): 0,
                (42524322, "_"): 948,
                (42525035, "G>A"): 0,
                (42525035, "_"): 1106,
                (42525068, "G>A"): 0,
                (42525068, "_"): 1003,
                (42525131, "C>G"): 447,
                (42525131, "_"): 180,
                (42525279, "G>A"): 0,
                (42525279, "_"): 1267,
                (42525298, "A>G"): 0,
                (42525298, "_"): 1351,
                (42525755, "G>A"): 0,
                (42525755, "_"): 690,
                (42525797, "G>C"): 0,
                (42525797, "_"): 247,
                (42525951, "A>C"): 729,
                (42525951, "_"): 194,
                (42526048, "G>C"): 594,
                (42526048, "_"): 372,
                (42526483, "C>A"): 708,
                (42526483, "_"): 291,
                (42526548, "T>C"): 861,
                (42526548, "_"): 237,
                (42526560, "T>G"): 886,
                (42526560, "_"): 221,
                (42526561, "C>G"): 879,
                (42526561, "_"): 221,
                (42526566, "A>G"): 891,
                (42526566, "_"): 230,
                (42526570, "G>C"): 896,
                (42526570, "_"): 230,
                (42526572, "G>T"): 911,
                (42526572, "_"): 243,
                (42526668, "C>T"): 517,
                (42526668, "_"): 983,
                (42527470, "C>T"): 834,
                (42527470, "_"): 273,
                (42527532, "G>A"): 688,
                (42527532, "_"): 257,
                (42527541, "delTC"): 0,
                (42527541, "_"): 916,
                (42528027, "T>C"): 21,
                (42528027, "_"): 4,
                (42528095, "C>T"): 0,
                (42528095, "_"): 4,
                (42528381, "G>C"): 19,
                (42528381, "_"): 16,
            },
            "sol": [
                ("2.001", [(42526579, "C>G")], []),
                ("2.001", [(42526579, "C>G")], []),
                ("71.002", [], []),
            ],
        },
    )


def test_fusion(real_gene, solver):  # HG01190/v1
    assert_minor(
        real_gene,
        solver,
        {
            "cn": {"1": 1, "68": 1},
            "major": {"4": 1, "68": 1},
            "data": {
                (42522391, "G>A"): 227,
                (42522391, "_"): 9,
                (42522612, "C>G"): 308,
                (42522612, "_"): 0,
                (42523210, "T>C"): 453,
                (42523210, "_"): 0,
                (42523408, "T>G"): 882,
                (42523408, "_"): 0,
                (42524695, "T>C"): 276,
                (42524695, "_"): 136,
                (42524946, "C>T"): 319,
                (42524946, "_"): 151,
                (42525131, "C>G"): 377,
                (42525131, "_"): 0,
                (42525797, "G>C"): 84,
                (42525797, "_"): 5,
                (42525810, "T>C"): 48,
                (42525810, "_"): 3,
                (42525820, "G>T"): 30,
                (42525820, "_"): 3,
                (42525951, "A>C"): 494,
                (42525951, "_"): 160,
                (42526048, "G>C"): 521,
                (42526048, "_"): 177,
                (42526483, "C>A"): 507,
                (42526483, "_"): 0,
                (42526693, "G>A"): 749,
                (42526693, "_"): 0,
                (42527792, "C>T"): 433,
                (42527792, "_"): 0,
                (42528027, "T>C"): 31,
                (42528027, "_"): 0,
                (42528223, "G>A"): 0,
                (42528223, "_"): 0,
            },
            "sol": [
                ("4.001", [(42526483, "C>A")], []),
                ("68.001", [(42528223, "G>A")], []),
            ],
        },
        shallow=True,
    )


def test_deletion(real_gene, solver):  # HG00276/v1
    assert_minor(
        real_gene,
        solver,
        {
            "cn": {"1": 1, "5": 1},
            "major": {"4": 1, "5": 1},
            "data": {
                (42522391, "G>A"): 212,
                (42522391, "_"): 7,
                (42522612, "C>G"): 277,
                (42522612, "_"): 0,
                (42523210, "T>C"): 248,
                (42523210, "_"): 8,
                (42523408, "T>G"): 547,
                (42523408, "_"): 0,
                (42524695, "T>C"): 306,
                (42524695, "_"): 94,
                (42524946, "C>T"): 291,
                (42524946, "_"): 86,
                (42525131, "C>G"): 357,
                (42525131, "_"): 0,
                (42525797, "G>C"): 106,
                (42525797, "_"): 5,
                (42525810, "T>C"): 73,
                (42525810, "_"): 3,
                (42525820, "G>T"): 57,
                (42525820, "_"): 0,
                (42525951, "A>C"): 271,
                (42525951, "_"): 132,
                (42526048, "G>C"): 301,
                (42526048, "_"): 151,  # Note this-- probably a mapping error!
                (42526483, "C>A"): 232,
                (42526483, "_"): 0,
                (42526693, "G>A"): 311,
                (42526693, "_"): 19,
                (42527792, "C>T"): 186,
                (42527792, "_"): 5,
                (42528027, "T>C"): 7,
                (42528027, "_"): 0,
            },
            "sol": [("4.001", [(42528223, "G>A")], []), ("5.001", [], [])],
        },
    )


# def test_comparison(real_gene, solver):  # NA06991/v1
#     data = {
#         (42522391, "G>A"): 342,
#         (42522391, "_"): 409,
#         (42522612, "C>G"): 428,
#         (42522612, "_"): 479,
#         (42522964, "C>T"): 0,
#         (42522964, "_"): 1083,
#         (42523210, "T>C"): 459,
#         (42523210, "_"): 341,
#         (42523408, "T>G"): 1165,
#         (42523408, "_"): 406,
#         (42524217, "G>T"): 0,
#         (42524217, "_"): 602,
#         (42524695, "T>C"): 434,
#         (42524695, "_"): 583,
#         (42524814, "G>A"): 0,
#         (42524814, "_"): 1399,
#         (42524923, "A>G"): 0,
#         (42524923, "_"): 1167,
#         (42524946, "C>T"): 493,
#         (42524946, "_"): 743,
#         (42525131, "C>G"): 346,
#         (42525131, "_"): 195,
#         (42525755, "G>A"): 0,
#         (42525755, "_"): 669,
#         (42525797, "G>C"): 92,
#         (42525797, "_"): 90,
#         (42525810, "T>C"): 42,
#         (42525810, "_"): 50,
#         (42525820, "G>T"): 15,
#         (42525820, "_"): 40,
#         (42525951, "A>C"): 528,
#         (42525951, "_"): 539,
#         (42526048, "G>C"): 594,
#         (42526048, "_"): 569,
#         (42526483, "C>A"): 369,
#         (42526483, "_"): 408,
#         (42526548, "T>C"): 0,
#         (42526548, "_"): 599,
#         (42526560, "T>G"): 0,
#         (42526560, "_"): 529,
#         (42526561, "C>G"): 0,
#         (42526561, "_"): 524,
#         (42526566, "A>G"): 0,
#         (42526566, "_"): 579,
#         (42526570, "G>C"): 0,
#         (42526570, "_"): 556,
#         (42526572, "G>T"): 0,
#         (42526572, "_"): 574,
#         (42526693, "G>A"): 688,
#         (42526693, "_"): 598,
#         (42527792, "C>T"): 360,
#         (42527792, "_"): 298,
#         (42528027, "T>C"): 11,
#         (42528027, "_"): 7,
#         (42528223, "G>A"): 2,
#         (42528223, "_"): 1,
#     }
#     s1 = assert_minor(
#         real_gene,
#         solver,
#         {
#             "cn": {"1": 2},
#             "major": {"1": 1, "4": 1},
#             "data": data,
#             "sol": [("1.001", [], []), ("4.001", [], [])],
#         },
#     )
#     s2 = assert_minor(
#         real_gene,
#         solver,
#         {
#             "cn": {"1": 2},
#             "major": {"10": 1, "4M": 1},
#             "data": data,
#             "sol": [
#                 ("10.001", [], []),
#                 (
#                     "4.012",
#                     [],
#                     [(42526483, "C>A"), (42527792, "C>T"), (42528223, "G>A")],
#                 ),
#             ],
#         },
#         shallow=True,
#     )
#     s3 = assert_minor(
#         real_gene,
#         solver,
#         {
#             "cn": {"1": 2},
#             "major": {"39": 1, "4J": 1},
#             "data": data,
#             "sol": [("39.002", [], []), ("4.009", [], [])],
#         },
#     )
#     assert s1 < s2
#     assert s1 < s3


def test_major_novel(real_gene, solver):
    assert_minor(
        real_gene,
        solver,
        {
            "cn": {"1": 2},
            "major": {"35": 1, ("4.b", (42525810, "T>C")): 1},
            "data": {
                (42522311, "C>T"): 279,
                (42522311, "_"): 147,
                (42522391, "G>A"): 315,
                (42522391, "_"): 317,
                (42522612, "C>G"): 618,
                (42522612, "_"): 0,
                (42523002, "G>A"): 477,
                (42523002, "_"): 245,
                (42523208, "C>T"): 316,
                (42523208, "_"): 410,
                (42523210, "T>C"): 419,
                (42523210, "_"): 316,
                (42523408, "T>G"): 858,
                (42523408, "_"): 0,
                (42523942, "G>A"): 356,
                (42523942, "_"): 326,
                (42524695, "T>C"): 301,
                (42524695, "_"): 322,
                (42524946, "C>T"): 362,
                (42524946, "_"): 387,
                (42525131, "C>G"): 304,
                (42525131, "_"): 0,
                (42525755, "G>A"): 0,
                (42525755, "_"): 359,
                (42525797, "G>C"): 31,
                (42525797, "_"): 56,
                (42525810, "T>C"): 16,
                (42525810, "_"): 19,
                (42525951, "A>C"): 831,
                (42525951, "_"): 0,
                (42526048, "G>C"): 850,
                (42526048, "_"): 0,
                (42526483, "C>A"): 660,
                (42526483, "_"): 0,
                (42526693, "G>A"): 417,
                (42526693, "_"): 311,
                (42526762, "C>T"): 535,
                (42526762, "_"): 460,
                (42526930, "T>C"): 0,
                (42526930, "_"): 563,
                (42527470, "C>T"): 573,
                (42527470, "_"): 257,
                (42527532, "G>A"): 354,
                (42527532, "_"): 222,
                (42527792, "C>T"): 273,
                (42527792, "_"): 263,
                (42528027, "T>C"): 14,
                (42528027, "_"): 1,
                (42528381, "G>C"): 6,
                (42528381, "_"): 12,
            },
            "sol": [
                ("35B", [(42526930, "T>C")], []),
                ("4EW", [], [(42525810, "T>C")]),
            ],
        },
        shallow=True,
    )
